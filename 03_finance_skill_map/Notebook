# Step 1: Import Required Libraries
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Step 2: Upload the dataset
from google.colab import files
uploaded = files.upload()

# Step 3: Load and preview the data
df = pd.read_csv('financial_skill_sample.csv')
print("✅ Original data loaded. Number of rows:", len(df))
df.head()

# Step 4: Data Cleaning
df.drop_duplicates(inplace=True)
df.dropna(inplace=True)

# Step 5: Feature Engineering - Count Skill Occurrence
skill_counts = df['Skill'].value_counts().reset_index()
skill_counts.columns = ['Skill', 'Count']
print("✅ Top 5 skills:")
print(skill_counts.head())

# Step 6: Visualization - Top 10 Skills
plt.figure(figsize=(12,6))
sns.barplot(x='Skill', y='Count', data=skill_counts.head(10))
plt.title('Top 10 Financial Skills in Job Postings')
plt.xticks(rotation=45)
plt.tight_layout()
plt.show()

# Step 7: Save cleaned dataset
df.to_csv('cleaned_financial_skills.csv', index=False)
print("✅ Cleaned dataset saved as cleaned_financial_skills.csv")

# Optional: Download the cleaned file
files.download('cleaned_financial_skills.csv')
