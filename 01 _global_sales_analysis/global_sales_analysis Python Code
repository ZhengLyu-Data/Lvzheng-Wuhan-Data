# Step 1: Import libraries
import pandas as pd

# Step 2: Upload and load the dataset
from google.colab import files
uploaded = files.upload() # Mannually upload train.csv here

# Step 3: Read CSV into DataFrame
df = pd.read_csv("train.csv")

# Step 4: Check columns and first few rows
print("Columns in the dataset:")
print(df.columns.tolist())

print("\n Preview of the dataset:")
print(df.head())

# Step 5: Drop duplicates and missing values
df_cleaned = df.drop_duplicates()
df_cleaned = df_cleaned.dropna()

# Step 6: Add any relevant calculated columns if needed
# Let's say this dataset is for retail sales production, we can check if a 'sales' column exists.
# If not, we'll leave this step as a placeholder
if 'UnitPrice' in df_cleaned.columns and 'Quantity' in df_cleaned.columns:
    df_cleaned['TotalSales'] = df_cleaned['UnitPrice'] * df_cleaned['Quantity']

# Step 7: Save the cleaned dataset
df_cleaned.to_csv("cleaned_train.csv", index=False)
print("Cleaned dataset saved as 'Cleaned_train.csv'")

from google.colab import files
files.download("cleaned_train.csv")
